<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="服务拆分在项目中是有帮助的，但是有帮助的「度」也存在，因为还有诸如「不同系统中存在代码冗余」等问题。等好的方式应该是服务化，就是将系统分层。  服务化就是之前提到的概念，存在多层，比如：顶层 Web 系统，中间服务中心，底层数据库。  1. 远程调用服务化带来了各种各样的问题，内部系统依赖变得错综复杂，我们需要解决它所带来的问题。 没有服务化之前，我们通过「本地调用」的方式使用其他组件，服务化以后">
<meta name="keywords" content="分布式,大型网站系统与 Java 中间件开发实践">
<meta property="og:type" content="article">
<meta property="og:title" content="从服务框架开始">
<meta property="og:url" content="http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/index.html">
<meta property="og:site_name" content="空城">
<meta property="og:description" content="服务拆分在项目中是有帮助的，但是有帮助的「度」也存在，因为还有诸如「不同系统中存在代码冗余」等问题。等好的方式应该是服务化，就是将系统分层。  服务化就是之前提到的概念，存在多层，比如：顶层 Web 系统，中间服务中心，底层数据库。  1. 远程调用服务化带来了各种各样的问题，内部系统依赖变得错综复杂，我们需要解决它所带来的问题。 没有服务化之前，我们通过「本地调用」的方式使用其他组件，服务化以后">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506131333.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506132735.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506135606.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506135756.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506192126.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506221252.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506221815.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508201105.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508203823.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508203944.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508204130.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508204404.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508204802.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205011.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205210.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205249.png">
<meta property="og:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205514.png">
<meta property="og:updated_time" content="2021-11-07T18:06:23.921Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="从服务框架开始">
<meta name="twitter:description" content="服务拆分在项目中是有帮助的，但是有帮助的「度」也存在，因为还有诸如「不同系统中存在代码冗余」等问题。等好的方式应该是服务化，就是将系统分层。  服务化就是之前提到的概念，存在多层，比如：顶层 Web 系统，中间服务中心，底层数据库。  1. 远程调用服务化带来了各种各样的问题，内部系统依赖变得错综复杂，我们需要解决它所带来的问题。 没有服务化之前，我们通过「本地调用」的方式使用其他组件，服务化以后">
<meta name="twitter:image" content="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506131333.png">
    
    
        
          
              <link rel="shortcut icon" href="//koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/fish_opt.png">
          
        
        
          
            <link rel="icon" type="image/png" href="//koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/fish_opt.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="//koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/fish_opt.png">
          
        
    
    <!-- title -->
    <title>从服务框架开始</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="https://github.com/koonchen">Projects</a></li>
         
          <li><a href="https://valeriehu1995.github.io">PigChain</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/technology/2019-05-11-java-distributed-system-chapter4/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/technology/2019-04-23-java-distributed-system-chapter2/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&text=从服务框架开始"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&is_video=false&description=从服务框架开始"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=从服务框架开始&body=Check out this article: http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&name=从服务框架开始&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-远程调用"><span class="toc-number">1.</span> <span class="toc-text">1. 远程调用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-服务框架原型"><span class="toc-number">2.</span> <span class="toc-text">2. 服务框架原型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-消费者设计"><span class="toc-number">3.</span> <span class="toc-text">3. 消费者设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-通信问题"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 通信问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-路由问题"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 路由问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-多机房场景"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 多机房场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-多种异步调用"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 多种异步调用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-提供者设计"><span class="toc-number">4.</span> <span class="toc-text">4. 提供者设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-不同服务的线程隔离"><span class="toc-number">4.1.</span> <span class="toc-text">4.2 不同服务的线程隔离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-分布式环境合并请求"><span class="toc-number">4.2.</span> <span class="toc-text">4.3 分布式环境合并请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-总结"><span class="toc-number">5.</span> <span class="toc-text">5. 总结</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        从服务框架开始
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">空城</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2019-04-23T16:00:00.000Z" itemprop="datePublished">2019-04-24</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/technology/">technology</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/分布式/">分布式</a>, <a class="tag-link" href="/tags/大型网站系统与-Java-中间件开发实践/">大型网站系统与 Java 中间件开发实践</a>
    </div>


    </div>
  </header>
  <!-- 
 -->
  <div class="content" itemprop="articleBody">
    <p>服务拆分在项目中是有帮助的，但是有帮助的「度」也存在，因为还有诸如「不同系统中存在代码冗余」等问题。等好的方式应该是<strong>服务化</strong>，就是将系统分层。</p>
<blockquote>
<p>服务化就是之前提到的概念，存在多层，比如：<strong>顶层 Web 系统，中间服务中心，底层数据库</strong>。</p>
</blockquote>
<h2 id="1-远程调用"><a href="#1-远程调用" class="headerlink" title="1. 远程调用"></a>1. 远程调用</h2><p>服务化带来了各种各样的问题，内部系统依赖变得错综复杂，我们需要解决它所带来的问题。</p>
<p>没有服务化之前，我们通过「本地调用」的方式使用其他组件，服务化以后我们需要使用的是「远程调用」，这里我们需要关注<strong>提高易用性</strong>与<strong>降低性能损失</strong>两个问题。</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506131333.png" alt></p>
<p><strong>因此一个通用的服务框架，要先完成 RPC 功能，为服务使用者提供相应的客户端</strong>。多机之间，我们需要对请求进行编码，传到远程节点，解码后进行真正的调用。</p>
<blockquote>
<ul>
<li>寻址路由：「调用方」确定哪个实例被调用。</li>
<li>实例地位：「被调用方」找到对应的实例进行调用。</li>
</ul>
</blockquote>
<h2 id="2-服务框架原型"><a href="#2-服务框架原型" class="headerlink" title="2. 服务框架原型"></a>2. 服务框架原型</h2><p>上面的图只是一个从一端到另外一端的请求，服务框架是一个<strong>既包含调用端逻辑又包含服务端逻辑的一个是实现</strong>。</p>
<p>在远程调用中，一般有如下的「请求流程」：</p>
<ol>
<li>获取可用服务地址列表；</li>
<li>确定调用的目标机器； // 这两步完成「寻址路由」，方式很多，规则服务器、名称服务等等。</li>
<li>建立连接；</li>
<li>请求序列化；</li>
<li>发送请求；</li>
<li>接收结果；</li>
<li>解析结果。</li>
</ol>
<p>而对于「服务端」而言，也要加入请求的处理：接收比特流，「实例定位」，返回结果。</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506132735.png" alt></p>
<h2 id="3-消费者设计"><a href="#3-消费者设计" class="headerlink" title="3. 消费者设计"></a>3. 消费者设计</h2><p>假设用 Spring 作为一个服务的框架，在 Bean 的定义中，需要指定这些 Bean 属性：「interfaceName」、「version」、「group」。</p>
<p>在本地通过「动态代理」的方式实现方法的调用。</p>
<ol>
<li>首先需要「interfaceName」确认被调用接口是哪一个，显然使用的是全限定名；</li>
<li>接着「version」主要用以升级的场景，让版本存在隔离；</li>
<li>最后「group」，假设同一个服务有很多机器，我们可以把这些服务的机器归组，选择不同的组来调用。</li>
</ol>
<p>「服务框架」可以作为：Web 应用的扩展（jar 包）、Web 容器的一部分（Web 应用）、本身作为容器。这些都可行，在开发中应该根据不同的场景来进行选择。</p>
<h3 id="3-1-通信问题"><a href="#3-1-通信问题" class="headerlink" title="3.1 通信问题"></a>3.1 通信问题</h3><p>我们的假想中调用的服务是一台的，但实际中一定是多台的集群：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506135606.png" alt></p>
<p>处理方式多种，可以采用「透明代理」或者「直连」的方式，主流采用「直连」的方式：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506135756.png" alt></p>
<p>引入一个「注册中心」来支持查找，让客户端拿到服务提供者列表，然后就是「路由」的问题了。</p>
<h3 id="3-2-路由问题"><a href="#3-2-路由问题" class="headerlink" title="3.2 路由问题"></a>3.2 路由问题</h3><p>「基于接口、方法、参数的路由」也是我们要解决的问题。下面两个调用者可能都调用同一个服务：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506192126.png" alt></p>
<p>假设现在接口 A 的方法 1 是比较慢的方法，可能会陷入不断的等待：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506221252.png" alt></p>
<p>我们会发现执行过程中很容易陷入 IA.m1 方法的等待队列，简单处理可以「增加资源保证系统能力」，另一种一种可行的方式「隔离资源」。</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190506221815.png" alt></p>
<p>现在只有接口 A 的方法 2 会收到接口 A 方法 1 的影响了，那么我们可以对路由更加细致一点，可以基于「具体方法进行路由」，而不是「基于接口进行路由」，沿着这个思路，还有「基于参数进行路由」的选择。</p>
<h3 id="3-3-多机房场景"><a href="#3-3-多机房场景" class="headerlink" title="3.3 多机房场景"></a>3.3 多机房场景</h3><p>如果在「服务注册中心」和「调用者」、「提供者」之间加上「机房」的概念。我们可以在「路由」中下文章：</p>
<p>给不同机房的调用者相同的服务提供者列表，然后根据「虚拟机房」等策略完成路由，一般是基于接口的路由（服务框架进行集中配置管理）。</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508201105.png" alt></p>
<p>另外流控是为了保证系统的稳定性，序列化是为了传输对象，网络一般采用 NIO ，这些都是老生常谈了。</p>
<h3 id="3-4-多种异步调用"><a href="#3-4-多种异步调用" class="headerlink" title="3.4 多种异步调用"></a>3.4 多种异步调用</h3><ul>
<li>Oneway<ul>
<li>只管发送不关心结果的方式。只需要把发送的数据放入数据队列，然后继续处理后续任务；而 IO 线程也只需要从数据队列中读到数据，然后通过 Socket 连接发送出去即可。它是<strong>不保证可靠传达</strong>的通知。</li>
</ul>
</li>
</ul>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508203823.png" alt></p>
<ul>
<li>Callback<ul>
<li>请求发送方发送请求后会继续执行自己的操作，等对方有响应时进行一个回调。</li>
</ul>
</li>
</ul>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508203944.png" alt></p>
<ul>
<li>Future<ul>
<li>先把 Future 放入队列，然后把数据放入队列，接着就在线程中进行处理，等到请求线程在其他工作处理结束后，就通过 Future 来获取通信结果并直接控制超时。</li>
</ul>
</li>
</ul>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508204130.png" alt></p>
<ul>
<li>可靠异步<ul>
<li>一般通过消息中间件完成。</li>
</ul>
</li>
</ul>
<h2 id="4-提供者设计"><a href="#4-提供者设计" class="headerlink" title="4. 提供者设计"></a>4. 提供者设计</h2><p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508204404.png" alt></p>
<p>在服务端我们也要像调用端一样设置特殊字段，以此暴露出远程服务的具体接口。</p>
<p>具体的请求流程从「网络通信层」一直延续到调用「具体服务」：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508204802.png" alt></p>
<h3 id="4-2-不同服务的线程隔离"><a href="#4-2-不同服务的线程隔离" class="headerlink" title="4.2 不同服务的线程隔离"></a>4.2 不同服务的线程隔离</h3><p>值得注意的是，服务端线程池不是一个，定位服务以后，根据名称、方法、参数等信息来决定具体执行服务调用的线程池是哪一个，不会出现争抢线程资源的情况：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205011.png" alt></p>
<h3 id="4-3-分布式环境合并请求"><a href="#4-3-分布式环境合并请求" class="headerlink" title="4.3 分布式环境合并请求"></a>4.3 分布式环境合并请求</h3><p>我们知道，合并请求的线程流程如下：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205210.png" alt></p>
<p>但是在分布式环境中，会有新的问题，需要使用「分布式锁」或者「路由」：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205249.png" alt></p>
<p>具体场景需要具体分析。</p>
<h2 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h2><p>服务框架为我们从集中式系统转向分布式系统提供了基础支持：</p>
<p><img src="https://koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/20190508205514.png" alt></p>
<p>完成服务框架，还需要针对自身环境完成工作，以助于开发中定位和发现问题。</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="https://github.com/koonchen">Projects</a></li>
         
          <li><a href="https://valeriehu1995.github.io">PigChain</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-远程调用"><span class="toc-number">1.</span> <span class="toc-text">1. 远程调用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-服务框架原型"><span class="toc-number">2.</span> <span class="toc-text">2. 服务框架原型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-消费者设计"><span class="toc-number">3.</span> <span class="toc-text">3. 消费者设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-通信问题"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 通信问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-路由问题"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 路由问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-多机房场景"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 多机房场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-4-多种异步调用"><span class="toc-number">3.4.</span> <span class="toc-text">3.4 多种异步调用</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-提供者设计"><span class="toc-number">4.</span> <span class="toc-text">4. 提供者设计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-不同服务的线程隔离"><span class="toc-number">4.1.</span> <span class="toc-text">4.2 不同服务的线程隔离</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-分布式环境合并请求"><span class="toc-number">4.2.</span> <span class="toc-text">4.3 分布式环境合并请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-总结"><span class="toc-number">5.</span> <span class="toc-text">5. 总结</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&text=从服务框架开始"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&is_video=false&description=从服务框架开始"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=从服务框架开始&body=Check out this article: http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&title=从服务框架开始"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://koon.cool/technology/2019-04-24-java-distributed-system-chapter3/&name=从服务框架开始&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 Koon Chen
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="https://github.com/koonchen">Projects</a></li>
         
          <li><a href="https://valeriehu1995.github.io">PigChain</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<!-- <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"> -->
<link rel="stylesheet" href="//cdn.staticfile.org/font-awesome/5.2.0/css/all.min.css">
<!-- <link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"> -->
<link rel="stylesheet" href="//cdn.staticfile.org/justifiedGallery/3.6.5/css/justifiedGallery.min.css">

    <!-- jquery -->
<!-- <script src="/lib/jquery/jquery.min.js"></script> -->
<script src="//cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
<!-- <script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script> -->
<script src="//cdn.staticfile.org/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-109260587-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
