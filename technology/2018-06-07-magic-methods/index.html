<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="资料柜：A Guide to Python’s Magic Methods  魔术方法 ( magic methods ) 是 python 的一种语法，允许在类的定义中使用，一般格式是 __xx__ ，它能对类进行功能上的额外增加，同时又非常方便，并且我们不得不去研究它。 为什么说不得不研究？比如我们知道使用 str() 可以将一个对象转换成 string 输出，那么 repr() 也能将一个">
<meta name="keywords" content="python">
<meta property="og:type" content="article">
<meta property="og:title" content="魔术方法">
<meta property="og:url" content="http://koon.cool/technology/2018-06-07-magic-methods/index.html">
<meta property="og:site_name" content="空城">
<meta property="og:description" content="资料柜：A Guide to Python’s Magic Methods  魔术方法 ( magic methods ) 是 python 的一种语法，允许在类的定义中使用，一般格式是 __xx__ ，它能对类进行功能上的额外增加，同时又非常方便，并且我们不得不去研究它。 为什么说不得不研究？比如我们知道使用 str() 可以将一个对象转换成 string 输出，那么 repr() 也能将一个">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2021-11-07T18:06:23.917Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="魔术方法">
<meta name="twitter:description" content="资料柜：A Guide to Python’s Magic Methods  魔术方法 ( magic methods ) 是 python 的一种语法，允许在类的定义中使用，一般格式是 __xx__ ，它能对类进行功能上的额外增加，同时又非常方便，并且我们不得不去研究它。 为什么说不得不研究？比如我们知道使用 str() 可以将一个对象转换成 string 输出，那么 repr() 也能将一个">
    
    
        
          
              <link rel="shortcut icon" href="//koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/fish_opt.png">
          
        
        
          
            <link rel="icon" type="image/png" href="//koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/fish_opt.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="//koonchenblog-1252050022.cos.ap-shanghai.myqcloud.com/img/blog/fish_opt.png">
          
        
    
    <!-- title -->
    <title>魔术方法</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="https://github.com/koonchen">Projects</a></li>
         
          <li><a href="https://valeriehu1995.github.io">PigChain</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/design-pattern/2018-06-11-factory-method/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/technology/2018-06-05-python-why/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://koon.cool/technology/2018-06-07-magic-methods/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://koon.cool/technology/2018-06-07-magic-methods/&text=魔术方法"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://koon.cool/technology/2018-06-07-magic-methods/&is_video=false&description=魔术方法"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=魔术方法&body=Check out this article: http://koon.cool/technology/2018-06-07-magic-methods/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://koon.cool/technology/2018-06-07-magic-methods/&name=魔术方法&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#用于创建删除实例"><span class="toc-number">1.</span> <span class="toc-text">用于创建删除实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#比较的魔术方法"><span class="toc-number">2.</span> <span class="toc-text">比较的魔术方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一元操作符"><span class="toc-number">3.</span> <span class="toc-text">一元操作符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二元操作符"><span class="toc-number">4.</span> <span class="toc-text">二元操作符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类的表示"><span class="toc-number">5.</span> <span class="toc-text">类的表示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#属性访问"><span class="toc-number">6.</span> <span class="toc-text">属性访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容器中的魔术方法"><span class="toc-number">7.</span> <span class="toc-text">容器中的魔术方法</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        魔术方法
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">空城</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2018-06-06T16:00:00.000Z" itemprop="datePublished">2018-06-07</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/technology/">technology</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/python/">python</a>
    </div>


    </div>
  </header>
  <!-- 
 -->
  <div class="content" itemprop="articleBody">
    <blockquote>
<p>资料柜：<br><a href="https://rszalski.github.io/magicmethods/#pickling" target="_blank" rel="noopener">A Guide to Python’s Magic Methods</a></p>
</blockquote>
<p>魔术方法 ( magic methods ) 是 python 的一种语法，允许在类的定义中使用，一般格式是 <code>__xx__</code> ，它能对类进行功能上的额外增加，同时又非常方便，并且我们不得不去研究它。</p>
<p>为什么说不得不研究？比如我们知道使用 <code>str()</code> 可以将一个对象转换成 string 输出，那么 <code>repr()</code> 也能将一个对象转换成 string 输出，它们的区别是什么？前者调用了 <code>__str__</code> 后者调用了 <code>__repr__</code> ，它们的魔术方法不同…</p>
<p>魔术方法怎么用呢？比如说我们要定义一个人 ，同时要有姓名、年龄，还要允许根据姓名和年龄进行排序：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#coding:utf8</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span><span class="params">(object)</span>:</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age)</span>:</span></span><br><span class="line">    self.name = name</span><br><span class="line">    self.age = age</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__str__</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> self.name + <span class="string">":"</span> + str(self.age)</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(self, other)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> self.name &lt; other.name \</span><br><span class="line">      <span class="keyword">if</span> self.name != other.name \</span><br><span class="line">      <span class="keyword">else</span> self.age &lt; other.age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">"\t"</span>.join(</span><br><span class="line">  [str(item)<span class="keyword">for</span> item <span class="keyword">in</span> sorted([People(<span class="string">"abc"</span>, <span class="number">18</span>),</span><br><span class="line">                                People(<span class="string">"qwd"</span>, <span class="number">19</span>),</span><br><span class="line">                                People(<span class="string">"wds"</span>, <span class="number">12</span>),</span><br><span class="line">                                People(<span class="string">"awd"</span>, <span class="number">17</span>)])])</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>这里用了三个魔术方法： <code>__init__</code> 初始化， <code>__str__</code> 字符串格式， <code>__lt__</code> 小于的含义。</p>
<p>或者说一个非常理性的需求，想对默认的 dict 进行修改，让它可以完成 <code>dict[1][1] = x</code> 这样的操作，当然默认是不行的，我们只能依靠 <code>dict.update({&#39;1&#39;:{&#39;1&#39;:x}})</code> 完成，非常绕口。想简便完成这个任务，首先我们无法确定 dict 中是否存在某个值，可以通过 <code>__getitem__</code> 函数重新定义：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyDict</span><span class="params">(dict)</span>:</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">__getitem__</span><span class="params">(self, item)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> item <span class="keyword">not</span> <span class="keyword">in</span> self:</span><br><span class="line">      temp = MyDict()</span><br><span class="line">      self[item]=temp</span><br><span class="line">      <span class="keyword">return</span> temp</span><br><span class="line">    <span class="keyword">return</span> self[item]</span><br><span class="line"></span><br><span class="line">test = MyDict()</span><br><span class="line">test[<span class="number">0</span>] = <span class="string">'test'</span></span><br><span class="line">test[<span class="number">1</span>][<span class="number">2</span>] = <span class="string">'test1'</span></span><br><span class="line">test[<span class="number">3</span>][<span class="number">4</span>][<span class="number">5</span>] = <span class="string">'test2'</span></span><br><span class="line">print(test)</span><br></pre></td></tr></table></figure>
<p>所以魔术方法给了我们非常多的便利。</p>
<h2 id="用于创建删除实例"><a href="#用于创建删除实例" class="headerlink" title="用于创建删除实例"></a>用于创建删除实例</h2><p>当一个实例被创建，最先被使用的方法是 <code>__new__(cls, *args, **kwargs)</code> ，它的第一个参数是类，后面的可变参数将传递给 <code>__init__</code> 使用，所以其追主要的目的是在 <code>__init__</code> 前做准备，而值得一提的是，这一切都是由元类的 <code>__call__</code> 控制的。</p>
<p>接下来是实例的初始化方法，使用的方法是 <code>__init__(self)</code> ，它的第一个参数是实例自身。</p>
<p>当对象的使命结束，在删除时调用的方法是 <code>__del__(self)</code> ，它相当于程序的析构器，但是它不能在解释器退出以后执行，所以它只在特定的环境下有作用，不是一个优美的编程习惯，对于 cpython 还是仰仗 gc 模块。</p>
<h2 id="比较的魔术方法"><a href="#比较的魔术方法" class="headerlink" title="比较的魔术方法"></a>比较的魔术方法</h2><p>在 python 语言中我们可能需要这样来进行等于的判断：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> instance.equals(other_instance) : <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>这样的操作可能会让产生困扰，于是有了 <code>__eq__</code> 方法，当实现其之后，可以这样：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> instance == other_instance : <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>
<p>这是比较的魔术方法的一个小例子。</p>
<p>最完善的比较是 <code>__cmp__</code> 它实现了所有的比较符号，包括了  <code>&lt;,==,&gt;,!=,etc.</code> ，但是它需要对每一个可能进行定义，比如 <code>self &lt; other</code> 返回0， <code>self = other</code> 返回负数， <code>self &gt; other</code> 返回正数。所以这个方法是让你保持所有状态明白的一个好方法。</p>
<p>下面列举其他比较用魔术方法。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__eq__</code></td>
<td>self, other</td>
<td>等号的行为</td>
</tr>
<tr>
<td><code>__ne__</code></td>
<td>self, other</td>
<td>不等号的行为</td>
</tr>
<tr>
<td><code>__lt__</code></td>
<td>self, other</td>
<td>小于号的行为</td>
</tr>
<tr>
<td><code>__gt__</code></td>
<td>self, other</td>
<td>大于等于号的行为</td>
</tr>
</tbody>
</table>
</div>
<p>这里值得一提的是 functools 模块，该模块大大降低了开发成本，其中的 <code>functool.partial</code> 通过包装类的手法，允许我们重新定义函数签名，什么意思呢？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">urlunquote = functools.partial(urlunquote, encoding=<span class="string">'latin1'</span>)</span><br><span class="line"><span class="comment"># 上面定义以后，下面的调用等价</span></span><br><span class="line"><span class="comment"># urlunquote(args, *kargs)</span></span><br><span class="line"><span class="comment"># urlunquote(args, *kargs, encoding='latin1')</span></span><br></pre></td></tr></table></figure>
<p>再比如说 <code>functool.update_wrapper</code> ，该函数可以补充封装函数的 <code>__name__、__module__、__doc__和 __dict__</code> 等信息，便于 debug。</p>
<p>而 <code>functools.wraps</code> 可以作为 <code>functool.update_wrapper</code> 的简易写法，以装饰器的方式使用。</p>
<p>此外还有 <code>reduce</code> 作为兼容 py3 ， <code>cmp_to_key</code> 小于负数大于整数等于为0， <code>total_ordering</code> 在实现 <code>__eq__</code>  和其他一个比较的前提下，自动实现其他比较的函数。</p>
<h2 id="一元操作符"><a href="#一元操作符" class="headerlink" title="一元操作符"></a>一元操作符</h2><p>顾名思义，一个操作位的一元操作，好比绝对值等。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__neg__</code></td>
<td>self</td>
<td>-</td>
</tr>
<tr>
<td><code>__pos__</code></td>
<td>self</td>
<td>+</td>
</tr>
<tr>
<td><code>__abs__</code></td>
<td>self</td>
<td>abs()</td>
</tr>
<tr>
<td><code>__invert__</code></td>
<td>self</td>
<td>~</td>
</tr>
<tr>
<td><code>__complex__</code></td>
<td>self</td>
<td>转换成复数</td>
</tr>
<tr>
<td><code>__int__</code></td>
<td>self</td>
<td>转换成整型</td>
</tr>
<tr>
<td><code>__long__</code></td>
<td>self</td>
<td>转换成长整型</td>
</tr>
<tr>
<td><code>__float__</code></td>
<td>self</td>
<td>转换成浮点型</td>
</tr>
<tr>
<td><code>__oct__</code></td>
<td>self</td>
<td>转换成八进制</td>
</tr>
<tr>
<td><code>__hex__</code></td>
<td>self</td>
<td>转换成十六进制</td>
</tr>
<tr>
<td><code>__round__</code></td>
<td>self, n</td>
<td>四舍五入</td>
</tr>
<tr>
<td><code>__floor__</code></td>
<td>self</td>
<td>向下取整</td>
</tr>
<tr>
<td><code>__ceil__</code></td>
<td>self</td>
<td>向上取整</td>
</tr>
<tr>
<td><code>__trunc__</code></td>
<td>self</td>
<td>距离 0 最近的整数</td>
</tr>
<tr>
<td><code>__coerce__</code></td>
<td>self</td>
<td>将一个列表转换成相同类型</td>
</tr>
</tbody>
</table>
</div>
<h2 id="二元操作符"><a href="#二元操作符" class="headerlink" title="二元操作符"></a>二元操作符</h2><p>好比加法。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__add__</code></td>
<td>self, other</td>
<td>加法</td>
</tr>
<tr>
<td><code>__sub__</code></td>
<td>self, other</td>
<td>减法</td>
</tr>
<tr>
<td><code>__mul__</code></td>
<td>self, other</td>
<td>乘法</td>
</tr>
<tr>
<td><code>__floordiv__</code></td>
<td>self, other</td>
<td>整除</td>
</tr>
<tr>
<td><code>__div__</code></td>
<td>self, other</td>
<td>除法</td>
</tr>
<tr>
<td><code>__truediv__</code></td>
<td>self, other</td>
<td>真除，但结果和除没有区别</td>
</tr>
<tr>
<td><code>__mod__</code></td>
<td>self, other</td>
<td>取模</td>
</tr>
<tr>
<td><code>__divmod__</code></td>
<td>self, other</td>
<td>如果两个参数 a , b 都是整数，那么会采用整数除法，结果相当于 <code>(a//b, a % b)</code> 。如果 a 或 b 是浮点数，相当于 <code>(math.floor(a/b), a%b)</code> 。</td>
</tr>
<tr>
<td><code>__pow__</code></td>
<td>self, other</td>
<td>指数 <code>**</code></td>
</tr>
<tr>
<td><code>__lshift__</code></td>
<td>self, other</td>
<td>左移</td>
</tr>
<tr>
<td><code>__rshift__</code></td>
<td>self, other</td>
<td>右移</td>
</tr>
<tr>
<td><code>__and__</code></td>
<td>self, other</td>
<td>按位 <code>&amp;</code></td>
</tr>
<tr>
<td><code>__or__</code></td>
<td>self, other</td>
<td>按位 `</td>
<td>`</td>
</tr>
<tr>
<td><code>__xor__</code></td>
<td>self, other</td>
<td>按位 <code>^</code></td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>省略反运算和增量赋值，没有区别且个人觉得没有太大意义，可以在使用时再查看。</p>
</blockquote>
<h2 id="类的表示"><a href="#类的表示" class="headerlink" title="类的表示"></a>类的表示</h2><p>什么叫类的表示？类在程序中的输出以及行为。比如输出 string，下面的方法在特定情况下一般只修改极个别，并且可以用 <code>obj.method()</code> 调用。其中的 <code>__sizeof__</code> 使用的是 <code>getsizeof()</code> 。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__str__</code></td>
<td>self</td>
<td>人读的输出</td>
</tr>
<tr>
<td><code>__repr__</code></td>
<td>self</td>
<td>机器读的输出</td>
</tr>
<tr>
<td><code>__unicode__</code></td>
<td>self</td>
<td>unicode 字符串</td>
</tr>
<tr>
<td><code>__hash__</code></td>
<td>self</td>
<td>hash 值</td>
</tr>
<tr>
<td><code>__nonzero__</code></td>
<td>self</td>
<td>将类转换成布尔值</td>
</tr>
<tr>
<td><code>__dir__</code></td>
<td>self</td>
<td>属性列表</td>
</tr>
<tr>
<td><code>__format__</code></td>
<td>self</td>
<td>格式化输出</td>
</tr>
<tr>
<td><code>__len__</code></td>
<td>self</td>
<td>输出长度</td>
</tr>
<tr>
<td><code>__sizeof__</code></td>
<td>self</td>
<td>输出内存</td>
</tr>
</tbody>
</table>
</div>
<h2 id="属性访问"><a href="#属性访问" class="headerlink" title="属性访问"></a>属性访问</h2><div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__getattr__</code></td>
<td>self, name</td>
<td>获取属性，必须存在</td>
</tr>
<tr>
<td><code>__setattr__</code></td>
<td>self, name</td>
<td>设置属性，无论是否存在</td>
</tr>
<tr>
<td><code>__delattr__</code></td>
<td>self, name</td>
<td>删除属性</td>
</tr>
<tr>
<td><code>__getattribute__</code></td>
<td>self, name</td>
<td>获取属性，无论是否存在</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p><em>PS: 在 <code>setattr</code> 中可能出现无限循环</em></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, name. value)</span>:</span></span><br><span class="line">  self.name = value</span><br><span class="line">  <span class="comment"># 因为每次属性幅值都要调用 __setattr__()，所以这里的实现会导致递归</span></span><br><span class="line">  <span class="comment"># 这里的调用实际上是 self.__setattr('name', value)。因为这个方法一直</span></span><br><span class="line">  <span class="comment"># 在调用自己，因此递归将持续进行，直到程序崩溃</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__setattr__</span><span class="params">(self, name, value)</span>:</span></span><br><span class="line">  self.__dict__[name] = value </span><br><span class="line">  <span class="comment"># 使用 __dict__ 进行赋值</span></span><br></pre></td></tr></table></figure>
<h2 id="容器中的魔术方法"><a href="#容器中的魔术方法" class="headerlink" title="容器中的魔术方法"></a>容器中的魔术方法</h2><div class="table-container">
<table>
<thead>
<tr>
<th>名称</th>
<th>参数</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>__len__</code></td>
<td>self</td>
<td>返回容器长度</td>
</tr>
<tr>
<td><code>__getitem__</code></td>
<td>self, key</td>
<td>返回某一项，必须存在</td>
</tr>
<tr>
<td><code>__setitem__</code></td>
<td>self, key</td>
<td>设置某一项，它将先使用 <code>__getitem__</code></td>
</tr>
<tr>
<td><code>__iter__</code></td>
<td>self, key</td>
<td>返回迭代器</td>
</tr>
<tr>
<td><code>__reversed__</code></td>
<td>self</td>
<td>反转</td>
</tr>
<tr>
<td><code>__contains__</code></td>
<td>self, item</td>
<td>是否存在某一项</td>
</tr>
<tr>
<td><code>__missing__</code></td>
<td>self ,key</td>
<td>不存在键时的行为</td>
</tr>
</tbody>
</table>
</div>
<hr>
<p>到这里，基本该使用的魔术方法已经列举了，其实还剩下很多，甚至无穷无尽，每一个包的创建，我们也就能创建一个又一个魔术方法，所以学习无止境，等待我们的探索。</p>
<blockquote>
<p>continue…</p>
</blockquote>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="https://github.com/koonchen">Projects</a></li>
         
          <li><a href="https://valeriehu1995.github.io">PigChain</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#用于创建删除实例"><span class="toc-number">1.</span> <span class="toc-text">用于创建删除实例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#比较的魔术方法"><span class="toc-number">2.</span> <span class="toc-text">比较的魔术方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一元操作符"><span class="toc-number">3.</span> <span class="toc-text">一元操作符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二元操作符"><span class="toc-number">4.</span> <span class="toc-text">二元操作符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#类的表示"><span class="toc-number">5.</span> <span class="toc-text">类的表示</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#属性访问"><span class="toc-number">6.</span> <span class="toc-text">属性访问</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#容器中的魔术方法"><span class="toc-number">7.</span> <span class="toc-text">容器中的魔术方法</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://koon.cool/technology/2018-06-07-magic-methods/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://koon.cool/technology/2018-06-07-magic-methods/&text=魔术方法"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://koon.cool/technology/2018-06-07-magic-methods/&is_video=false&description=魔术方法"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=魔术方法&body=Check out this article: http://koon.cool/technology/2018-06-07-magic-methods/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://koon.cool/technology/2018-06-07-magic-methods/&title=魔术方法"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://koon.cool/technology/2018-06-07-magic-methods/&name=魔术方法&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2021 Koon Chen
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="https://github.com/koonchen">Projects</a></li>
         
          <li><a href="https://valeriehu1995.github.io">PigChain</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->
<!-- <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"> -->
<link rel="stylesheet" href="//cdn.staticfile.org/font-awesome/5.2.0/css/all.min.css">
<!-- <link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css"> -->
<link rel="stylesheet" href="//cdn.staticfile.org/justifiedGallery/3.6.5/css/justifiedGallery.min.css">

    <!-- jquery -->
<!-- <script src="/lib/jquery/jquery.min.js"></script> -->
<script src="//cdn.staticfile.org/jquery/3.3.1/jquery.min.js"></script>
<!-- <script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script> -->
<script src="//cdn.staticfile.org/justifiedGallery/3.6.5/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-109260587-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
